#!/usr/bin/python2

import argparse
import time
from pwn import *

parser = argparse.ArgumentParser()
parser.add_argument("ip", help="The IP to connect to.")
parser.add_argument("port", help="The first port that should be knocked.", type=int)
args = parser.parse_args()

delay = 0
new_port = args.port
for i in range(10):
	time.sleep(delay)
	conn = remote(args.ip, new_port)
	answer = conn.recvline()
	conn.close()
	print(answer)
	split_answer = answer.split(" ")
	new_port = int(split_answer[1])
	delay = int(split_answer[3])
	print(str(new_port) + " " + str(delay))
